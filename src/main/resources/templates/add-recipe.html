<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/fragments/head}">
</head>
<body>
<!--<div class="wrapper">-->
<!-- Navigation -->
<header th:replace="~{/fragments/navigation}">
</header>



<!-- Top Container -->
<div class="row justify-content-center ">
    <form id="add-recipe-form"
          class="w-50 rounded text-white mt-5"
          th:action="@{/recipes/add}"
          th:method="POST"
          th:object="${recipeAddForm}"
          enctype="multipart/form-data">

        <h3 class="border-left border-light pl-2">Add a new recipe</h3>

        <div>
            <div class="form-group">
                <label for="inputTitle" class="col-form-label ">Title</label>
            </div>

            <div class="form-group">
                <input name="title"
                       th:value="*{title}"
                       type="text"
                       id="inputTitle"
                       class="form-control"
                       aria-describedby="inputTitleError">
                <small th:if="${#fields.hasErrors('title')}"
                       id="inputTitleError"
                       class="invalid-feedback bg-danger rounded">Title length must be more than 3 characters</small>
            </div>
        </div>

        <div>
            <div class="form-group">
                <label for="inputDescription" class="col-form-label ">Description</label>
            </div>
            <div class="form-group">
                    <textarea name="description"
                              th:value="*{description}"
                              required minlength="5"
                              id="inputDescription"
                              class="form-control"
                              aria-describedby="inputDescriptionError">
                    </textarea>
            </div>
            <small th:if="${#fields.hasErrors('description')}"
                   id="inputDescriptionError"
                   class="invalid-feedback  form-text bg-danger rounded">
                Description length must be more than 5 characters</small>
        </div>


        <div>
            <div class="form-group">
                <label for="nameCategory">Category</label>
                <select name="nameCategory" id="nameCategory" class="custom-select" th:field="*{nameCategory}">
                    <option value="" selected>Select category</option>
                    <option th:each="nameCategory : ${T(bg.tuplovdiv.cookingrecipes.domain.enums.NameCategory).values()}"
                            th:value="${nameCategory}"
                            th:text="${nameCategory}">
                    </option>
                </select>
                <small th:if="${#fields.hasErrors('nameCategory')}"
                       id="nameCategoryError"
                       class="invalid-feedback  form-text bg-danger rounded">Category Must not be null</small>
            </div>
        </div>



        <label for="cookingTime">Cooking Time:</label>
        <input type="text"
               id="cookingTime"
               name="cookingTime"
               th:field="*{cookingTime}" />

        <div class="form-group">
            <label class="text-white font-weight-bold" for="imageUrl">Image URL</label>
            <input id="imageUrl" type="url" class="form-control"
                   placeholder="Put recipe image URL here">
            <p class="errors alert alert-danger">
                Recipe image URL is required.
            </p>
        </div>


        <table id="recipes_ingredients">
            <tr th:each="ingre : *{recipeIngredientList}">
                <th text="${ingre.ingredient}"> Ingredients ++

                </th>
            </tr>
            <!-- Iterate through recipe ingredients -->
            <tr th:each="ingredient, rowStat : *{recipeIngredientList}">
                <td>
                    Ingredient:

                    <input type="text" th:field="*{recipeIngredientList[__${rowStat.index}__].ingredient.name}" />
                </td>
                <td>
                    <select name="measureUnit" id="measureUnit" class="custom-select" th:field="*{recipeIngredientList[__${rowStat.index}__].measureUnit.measureUnitType}">
                        <option value="" selected>Select measure unit</option>
                        <option th:each="measureUnit : ${T(bg.tuplovdiv.cookingrecipes.domain.enums.MeasureUnitType.values()}"
                                th:value="${measureUnit}"
                                th:text="${measureUnit}">
                        </option>
                    </select>
<!--                    <input type="text" th:field="*{recipeIngredientList[__${rowStat.index}__].measureUnit.measureUnitType}" />-->
                </td>
                <td>
                    <input type="text" th:field="*{recipeIngredientList[__${rowStat.index}__].amount}" />
                    <div class="col-auto">
                        <label for="inputAmount" class="col-form-label ">Amount</label>
                    </div>
                    <div class="col-auto">
                        <input name="amount" required
                               th:value="*{amount}"
                               type="number"
                               id="inputAmount"
                               class="form-control"
                               min="0" max="1000">
                    </div>
                </td>
                <td>
                    <a th:href="@{/removeIngredient/{index}(index=*{rowStat.index})}" th:if="${rowStat.index > 0}">Remove</a>
                </td>
            </tr>
        </table>
        <button type="button" onclick="addIngredient()">Add Ingredient</button>



        <div class="d-flex justify-content-center mt-4">
            <button class="btn btn-primary btn-block w-50" type="submit">Add Recipe</button>
        </div>

    </form>
</div>

<footer class="footer bg-blur rounded">
    <div class="container-fluid text-center">
        <div class="h5 text-white">
            &copy; Healthylicious. All rights reserved.
        </div>
    </div>
</footer>

</body>
</html>